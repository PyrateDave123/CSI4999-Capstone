let e=0;function n(n,t){const o=n.ownerDocument;!function(n){0===e&&(e=1,n.addEventListener("ionBackButton",e=>{const t=i(n);t&&t.backdropDismiss&&e.detail.register(100,()=>t.dismiss(void 0,l))}),n.addEventListener("keyup",e=>{if("Escape"===e.key){const e=i(n);e&&e.backdropDismiss&&e.dismiss(void 0,l)}}))}(o),Object.assign(n,t),n.classList.add("ion-page-invisible");const a=e++;return n.overlayIndex=a,n.hasAttribute("id")||(n.id=`ion-overlay-${a}`),s(o).appendChild(n),n.componentOnReady()}function t(e,n,t,o,a){const s=i(e,o,a);return s?s.dismiss(n,t):Promise.reject("overlay does not exist")}function i(e,n,t){const i=function(e,n){const t=Array.from(s(e).children).filter(e=>e.overlayIndex>0);return void 0===n?t:(n=n.toUpperCase(),t.filter(e=>e.tagName===n))}(e,n);return void 0===t?i[i.length-1]:i.find(e=>e.id===t)}async function o(e,n,t,i,o){if(e.presented)return;e.presented=!0,e.willPresent.emit();const a=e.enterAnimation?e.enterAnimation:e.config.get(n,"ios"===e.mode?t:i);await r(e,a,e.el,o)&&e.didPresent.emit()}async function a(e,n,t,i,o,a,s){if(!e.presented)return!1;e.presented=!1;try{e.willDismiss.emit({data:n,role:t});const d=e.leaveAnimation?e.leaveAnimation:e.config.get(i,"ios"===e.mode?o:a);await r(e,d,e.el,s),e.didDismiss.emit({data:n,role:t})}catch(e){console.error(e)}return e.el.remove(),!0}function s(e){return e.querySelector("ion-app")||e.body}async function r(e,n,t,i){if(e.animation)return e.animation.destroy(),e.animation=void 0,!1;{t.classList.remove("ion-page-invisible");const o=t.shadowRoot||e.el,a=e.animation=await e.animationCtrl.create(n,o,i);e.animation=a,e.animated||a.duration(0),e.keyboardClose&&a.beforeAddWrite(()=>{const e=t.ownerDocument.activeElement;e&&e.matches("input, ion-input, ion-textarea")&&e.blur()}),await a.playAsync();const s=a.hasCompleted;return a.destroy(),e.animation=void 0,s}}function d(e,n){let t;const i=new Promise(e=>t=e);return function(e,n,i){const o=i=>{e.removeEventListener(n,o),(e=>{t(e.detail)})(i)};e.addEventListener(n,o)}(e,n),i}function c(e){return"cancel"===e||e===l}const l="backdrop";export{l as a,a as b,d as c,c as d,o as e,n as f,t as g,i as h};