"use strict";
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result["default"] = mod;
    return result;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const schematics_1 = require("@angular-devkit/schematics");
const testing_1 = require("@angular-devkit/schematics/testing");
const path = __importStar(require("path"));
const vue_pkg_json_1 = __importDefault(require("./vue-pkg.json"));
const collectionPath = path.join(__dirname, '../collection.json');
const defaultOptions = {
    issuer: 'https://dev-737523.okta.com/oauth2/default',
    clientId: '0oaifymbuodpH8nAi0h7'
};
describe('OktaDev Schematics: Vue', () => {
    it('requires required issuer option', () => {
        const runner = new testing_1.SchematicTestRunner('schematics', collectionPath);
        expect(() => runner.runSchematic('add-auth', {}, schematics_1.Tree.empty())).toThrow();
    });
    it('works', () => {
        const tree = new testing_1.UnitTestTree(new schematics_1.HostTree);
        // Add package.json
        tree.create('/package.json', JSON.stringify(vue_pkg_json_1.default));
        const runner = new testing_1.SchematicTestRunner('schematics', collectionPath);
        runner.runSchematic('add-auth', Object.assign({}, defaultOptions), tree);
        expect(tree.files.length).toEqual(3);
        expect(tree.files.sort()).toEqual(['/package.json', '/src/App.vue', '/src/router.js']);
        const routerContent = tree.readContent('/src/router.js');
        expect(routerContent).toMatch(/Auth\.handleCallback\(\)/);
        expect(routerContent).toContain(`issuer: '${defaultOptions.issuer}'`);
        expect(routerContent).toContain(`client_id: '${defaultOptions.clientId}'`);
    });
});
//# sourceMappingURL=vue_spec.js.map